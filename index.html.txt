<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Simulador Imobili치rio Herbert Faber</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- PWA -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#1e40af">

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-100">

  <!-- TOPO -->
  <header class="flex items-center px-6 py-4 bg-white border-b shadow-sm">
    <img src="img/logo-herbert-faber.png" alt="Herbert Faber" class="h-12">
  </header>

  <!-- CONTE칔DO -->
  <main class="max-w-5xl mx-auto p-6 space-y-6">

    <!-- CONFIGURA칂츾O -->
    <section class="bg-white p-6 rounded-xl shadow space-y-4">

      <h2 class="text-lg font-bold text-gray-700">Configura칞칚o Financeira</h2>

      <input id="valorUnidade" type="number"
        placeholder="Valor do im칩vel"
        class="w-full p-2 border rounded"
        oninput="atualizar()">

      <input id="ato" type="number"
        placeholder="Ato / Sinal"
        class="w-full p-2 border rounded"
        oninput="atualizar()">

      <!-- Mensais -->
      <div class="grid grid-cols-2 gap-2">
        <input id="mensalQtd" type="number"
          placeholder="Qtd de meses"
          class="p-2 border rounded"
          oninput="atualizar()">

        <input id="mensalValor" type="number"
          placeholder="Valor mensal"
          class="p-2 border rounded"
          oninput="atualizar()">
      </div>

      <!-- Anuais -->
      <div class="grid grid-cols-2 gap-2">
        <input id="anualQtd" type="number"
          placeholder="Qtd anuais"
          class="p-2 border rounded"
          oninput="atualizar()">

        <input id="anualValor" type="number"
          placeholder="Valor anual"
          class="p-2 border rounded"
          oninput="atualizar()">
      </div>

      <input id="unica" type="number"
        placeholder="Parcela 칰nica"
        class="w-full p-2 border rounded"
        oninput="atualizar()">

      <button onclick="limparSimulacao()"
        class="w-full bg-gray-700 text-white py-2 rounded hover:bg-gray-800">
        游대 Simular outro cen치rio
      </button>

    </section>

    <!-- RESULTADO -->
    <section class="bg-white p-6 rounded-xl shadow space-y-2">
      <p class="text-sm text-gray-500">Saldo de financiamento</p>
      <h2 id="view-saldo" class="text-3xl font-bold text-green-600">
        R$ 0,00
      </h2>

      <p class="text-sm text-gray-500">
        Proposta v치lida at칠:
        <span id="validade" class="font-bold"></span>
      </p>
    </section>

  </main>

  <!-- SCRIPT -->
  <script>
    const moeda = valor =>
      valor.toLocaleString("pt-BR", { style: "currency", currency: "BRL" });

    function atualizar() {
      const valorUnidade = Number(document.getElementById("valorUnidade").value) || 0;
      const ato = Number(document.getElementById("ato").value) || 0;

      const mensalQtd = Number(document.getElementById("mensalQtd").value) || 0;
      const mensalValor = Number(document.getElementById("mensalValor").value) || 0;

      const anualQtd = Number(document.getElementById("anualQtd").value) || 0;
      const anualValor = Number(document.getElementById("anualValor").value) || 0;

      const unica = Number(document.getElementById("unica").value) || 0;

      const totalPago =
        ato +
        mensalQtd * mensalValor +
        anualQtd * anualValor +
        unica;

      const saldo = valorUnidade - totalPago;

      document.getElementById("view-saldo").innerText = moeda(saldo);

      const data = new Date();
      data.setDate(data.getDate() + 7);
      document.getElementById("validade").innerText =
        data.toLocaleDateString("pt-BR");

      localStorage.setItem("simulacao", JSON.stringify({
        valorUnidade,
        ato,
        mensalQtd,
        mensalValor,
        anualQtd,
        anualValor,
        unica
      }));
    }

    function limparSimulacao() {
      ["ato", "mensalQtd", "mensalValor", "anualQtd", "anualValor", "unica"]
        .forEach(id => document.getElementById(id).value = "");
      atualizar();
    }

    window.onload = () => {
      const dados = JSON.parse(localStorage.getItem("simulacao"));
      if (!dados) return;

      Object.keys(dados).forEach(id => {
        const el = document.getElementById(id);
        if (el) el.value = dados[id];
      });

      atualizar();
    };

    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("service-worker.js");
    }
  </script>

</body>
</html>